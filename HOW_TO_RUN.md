# HOW TO RUN THE SYSTEM - Step by Step Guide

## üöÄ Quick Start (3 Easy Steps)

### Step 1: Compile the Code (Only needed once)
Open PowerShell in the project directory and run:
```powershell
javac *.java
```
OR use the script:
```powershell
.\run.ps1 compile
```

### Step 2: Start the Server
In PowerShell Terminal 1:
```powershell
java Server
```
OR:
```powershell
.\run.ps1 server
```

You should see:
```
=== REAL-TIME STOCK MANAGEMENT SERVER ===
Server starting on port 8888...
Server is running and waiting for connections...
```

### Step 3: Connect Clients
Open a NEW PowerShell terminal (Terminal 2) and run:
```powershell
java SimpleClient
```
OR:
```powershell
.\run.ps1 client
```

You can open multiple client terminals to test concurrent access!

---

## üìã Detailed Instructions

### Method 1: Using the Helper Script (EASIEST)

1. **Compile** (do this once):
   ```powershell
   .\run.ps1 compile
   ```

2. **Start Server** (Terminal 1):
   ```powershell
   .\run.ps1 server
   ```

3. **Connect Client** (Terminal 2, 3, 4...):
   ```powershell
   .\run.ps1 client
   ```

4. **Run Tests** (New Terminal, server must be running):
   ```powershell
   .\run.ps1 test
   ```

### Method 2: Manual Java Commands

1. **Compile**:
   ```powershell
   javac *.java
   ```

2. **Start Server**:
   ```powershell
   java Server
   ```

3. **Start Client**:
   ```powershell
   java SimpleClient
   ```

4. **Run Tests**:
   ```powershell
   java ConcurrentStressTest
   ```

---

## üí° Using the Client

### When you connect, you'll be asked:

1. **Enter your username:**
   - Type any name (e.g., "John", "Admin1", "User1")

2. **Are you an admin? (yes/no):**
   - Type "yes" for admin privileges (can add/update products)
   - Type "no" for regular user (can only buy and view)

### Available Commands:

#### For ALL Users:
```
LIST                           - View all products
BUY_STOCK 1 5                  - Buy 5 units of product ID 1
ANALYTICS                      - Show total inventory value
LOW_STOCK 15                   - Show products with < 15 units
DAILY_REPORT                   - Generate detailed report
HELP                           - Show all commands
EXIT                           - Disconnect
```

#### For ADMIN Users Only:
```
ADD_PRODUCT Headphones 20 150.00    - Add new product
ADD_STOCK 1 10                      - Add 10 units to product ID 1
UPDATE_PRICE 2 29.99                - Update price of product ID 2
REMOVE_PRODUCT 3                    - Remove product ID 3
```

---

## üß™ Testing the System

### Test 1: Single User Test
1. Start server
2. Connect 1 client
3. Try different commands:
   ```
   LIST
   BUY_STOCK 1 2
   ANALYTICS
   DAILY_REPORT
   ```

### Test 2: Multi-User Test (Thread Safety)
1. Start server
2. Open 3-4 client terminals
3. Have all clients try to buy the same product simultaneously
4. Verify inventory doesn't go negative

### Test 3: Admin vs User Priority (Requirement B)
1. Start server
2. Connect as admin in one terminal (say "yes" to admin prompt)
3. Connect as user in another terminal (say "no" to admin prompt)
4. Admin thread gets higher priority (Priority 8 vs 5)

### Test 4: Automated Stress Test (Requirement H)
1. Start server
2. Run: `.\run.ps1 test` or `java ConcurrentStressTest`
3. Press Enter when prompted
4. Watch 20 concurrent clients hammer the server
5. Check results summary

---

## üìä Example Session

### Server Terminal:
```
=== REAL-TIME STOCK MANAGEMENT SERVER ===
Server starting on port 8888...
Server is running and waiting for connections...

New client connected! Client ID: 1 | Address: 127.0.0.1
Client-1 thread started. Active threads: 15
New client connected! Client ID: 2 | Address: 127.0.0.1
Client-2 thread started. Active threads: 16
```

### Client Terminal:
```
=== STOCK MANAGEMENT CLIENT ===
Connecting to server at localhost:8888...

Connected to server!

=== REAL-TIME STOCK MANAGEMENT SYSTEM ===
Enter your username:
> John

Are you an admin? (yes/no):
> no

Welcome John!

Type HELP for available commands.
---

> LIST
=== INVENTORY LIST ===
Product[ID=1, Name=Laptop, Qty=10, Price=999.99]
Product[ID=2, Name=Mouse, Qty=50, Price=25.50]
Product[ID=3, Name=Keyboard, Qty=30, Price=75.00]
Product[ID=4, Name=Monitor, Qty=15, Price=299.99]
Product[ID=5, Name=USB Cable, Qty=100, Price=9.99]
Total Products: 5
---

> BUY_STOCK 1 2
SUCCESS: Purchased 2 units of Laptop. Total: $1999.98. Remaining stock: 8
---

> ANALYTICS
Total Inventory Value: $15149.81
---

> DAILY_REPORT
Generating daily report... Please wait.

=== DAILY INVENTORY REPORT ===
Generated by: John
Timestamp: Sun Dec 29 10:30:45 MYT 2025

Total Product Types: 5
Total Units in Stock: 193
Total Inventory Value: $15149.81

Product Breakdown:
  - Laptop: 8 units @ $999.99 = $7999.92
  - Mouse: 50 units @ $25.50 = $1275.00
  - Keyboard: 30 units @ $75.00 = $2250.00
  - Monitor: 15 units @ $299.99 = $4499.85
  - USB Cable: 100 units @ $9.99 = $999.00

=== END OF REPORT ===
---

> EXIT
Goodbye John!
Disconnecting...
```

---

## üîç Verifying Requirements

### Requirement A (Threads): ‚úÖ
- Each client connection creates a new thread
- Check server output: "Client-X thread started"

### Requirement B (Priority): ‚úÖ
- Admin gets Priority 8, Users get Priority 5
- Connect as admin and regular user to see difference

### Requirement C (Join): ‚úÖ
- Run `DAILY_REPORT` command
- You'll see "Please wait" - main thread is waiting for report thread

### Requirement D (Deadlock): ‚úÖ
- Run stress test with 20+ clients
- System handles all without deadlock

### Requirement E (Synchronization): ‚úÖ
- Multiple clients buying same product
- Inventory stays consistent (check with LIST)

### Requirement F (ReentrantLock): ‚úÖ
- Use `UPDATE_PRICE` command (admin only)
- Code uses ReentrantLock instead of synchronized

### Requirement G (Parallel Streams): ‚úÖ
- Run `ANALYTICS` command
- Uses parallelStream() for calculation

### Requirement H (Testing): ‚úÖ
- Run `.\run.ps1 test`
- 20 concurrent clients stress-test the system

---

## ‚ö†Ô∏è Troubleshooting

### "Cannot connect to server"
- Make sure server is running first
- Check server shows "Server is running and waiting for connections..."

### "Port 8888 already in use"
- Close any existing server instances
- Or change PORT in Server.java

### "javac is not recognized"
- Java JDK not installed or not in PATH
- Install JDK 17+ and add to PATH

### Compilation errors
- Make sure all 6 Java files are in the same directory
- Use Java 17 or higher

### Client disconnects immediately
- Server might not be running
- Check for errors in server terminal

---

## üéØ System Flow

```
1. Server starts ‚Üí Listens on port 8888
2. Client connects ‚Üí Server creates new thread
3. Client sends command ‚Üí ClientHandler processes
4. ClientHandler calls InventoryManager ‚Üí Thread-safe operations
5. Response sent back to client
6. Multiple clients can connect simultaneously
```

---

## üìù Notes

- **Server** must be running before starting clients
- You can have **unlimited clients** connected simultaneously
- Each client runs on its **own thread** (Requirement A)
- **Admin users** get higher thread priority (Requirement B)
- System is **thread-safe** - test with multiple clients
- Use **Ctrl+C** to stop server or client
- Type **EXIT** in client to disconnect gracefully

---

## üéì For Grading/Demo

To demonstrate all requirements:

1. **Start server**: `.\run.ps1 server`
2. **Connect 2 clients**: One admin, one user
3. **Show thread creation**: Check server logs
4. **Show priority**: Admin vs user threads
5. **Show join**: Run DAILY_REPORT
6. **Show sync**: Both clients buy same product
7. **Show lock**: Admin updates price
8. **Show parallel**: Run ANALYTICS
9. **Show testing**: Run `.\run.ps1 test`
10. **Show no deadlock**: Stress test completes successfully

---

Good luck with your project! üöÄ

